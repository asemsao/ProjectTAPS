<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="SpecialAppraisal">
	<select id="getAllSpecialAppraisal"
		resultClass="adins.ace.taps.bean.specialAppraisal.SpecialAppraisalBean">
		SELECT to_char(s.created_date,'DD-MM-YYYY') AS
		createdDate,s.user_domain as userDomain,
		e.first_name||' '||e.last_name AS employeeName,
		SUM(s.star_after)-SUM(s.star_before) AS appraisalStar, s.description as description, s.star_id AS starId
		FROM stars s,
		employees e
		WHERE s.user_domain=e.user_domain
		group by s.created_date,s.user_domain, s.star_id,
		e.first_name||' '||e.last_name, s.description
	</select>

	<select id="ViewSpecialAppraisal"
		resultClass="adins.ace.taps.bean.specialAppraisal.SpecialAppraisalBean">
		SELECT to_char(s.created_date,'DD-MM-YYYY') AS
		createdDate,s.user_domain as userDomain,
		e.first_name||' '||e.last_name AS employeeName,
		SUM(s.star_after)-SUM(s.star_before) AS appraisalStar, s.description AS description, s.star_id AS starId
		FROM stars s,
		employees e
		WHERE s.user_domain=e.user_domain and s.star_id=LOWER(#starId#)
		group by s.created_date,s.user_domain, s.star_id,
		e.first_name||' '||e.last_name, s.description
	</select>

	<!-- <select id="countSpecialAppraisal" resultClass="int" -->
	<!-- parameterClass="java.util.Map"> -->
	<!-- SELECT COUNT(1) -->
	<!-- FROM stars s, employees e -->
	<!-- WHERE -->
	<!-- s.user_domain=e.user_domain -->
	<!-- </select> -->

	<!-- <select id="searchSpecialAppraisal" resultClass="SpecialAppraisalBean" -->
	<!-- parameterClass="java.util.Map"> -->
	<!-- SELECT * -->
	<!-- FROM (SELECT ROWNUM seqnum, a.* -->
	<!-- FROM (SELECT -->
	<!-- to_char(s.created_date,'DD-MM-YYYY') AS -->
	<!-- createdDate, -->
	<!-- e.first_name||' -->
	<!-- '||e.last_name AS employeeName, -->
	<!-- SUM(s.star_after)-SUM(s.star_before) AS -->
	<!-- appraisalStar -->
	<!-- FROM stars s, -->
	<!-- employees e -->
	<!-- WHERE s.user_domain=e.user_domain -->
	<!-- group by s.created_date, -->
	<!-- e.first_name||' '||e.last_name -->
	<!-- ) -->
	<!-- a -->
	<!-- WHERE <![CDATA[ ROWNUM <= #end#]]> -->
	<!-- ) -->
	<!-- WHERE <![CDATA[ seqnum >= #start#]]> -->
	<!-- </select> -->

</sqlMap>